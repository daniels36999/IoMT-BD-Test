<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport"content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		
		<title>HISTORIAL IoMT</title>
		
		<script   src="https://code.jquery.com/jquery-2.2.4.min.js"integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="   crossorigin="anonymous"></script>

	   <!-- LIBRERIAS EXCEL-->
		<script src="https://unpkg.com/xlsx@0.16.9/dist/xlsx.full.min.js"></script>
		<script src="https://unpkg.com/file-saverjs@latest/FileSaver.min.js"></script>
		<script src="https://unpkg.com/tableexport@latest/dist/js/tableexport.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.js"></script>
	</head>

	<body>
		<div class="container">
			<div class="card">
				<div class="card-header">
					REPORTE IOMT
				</div>
				<div class="card-body">
					<button id="btnExportar" class="btn btn-success">
						<i class="fas fa-file-excel"></i> DESCARGAR HISTORIAL
					</button>
					<table id="tabla" class="table table-border table-hover">
						<thead>
							<tr><th>Nombre:</th><th>Daniel Patricio</th></tr>				
							<tr><th>Apellido:</th><th>Yautibug Apugllon</th></tr>
							<tr><th>Cedula:</th><th>06060606</th></tr>
							<tr><th>Curso:</th><th>Otros</th></tr>
							<tr><th></th><th></th></tr>				
						
							<tr><th>Fecha</th>
							<th>Hora</th>
							<th>Temperatura</th>
							<th>Peso</th>
							<th>Altura</th>
							<th>IMC</th>
							<th>O2Sat</th></tr>
						</thead>
						<tbody>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<tr><td class="GF">01/06/22</td><td class="GH">10:50</td><td class="GT">30.31</td><td class="GP">86.15</td><td class="GE">1.06</td><td class="GI">76.67</td><td class="GO">45.66</td></tr>
							<!-- AGREGAR TABLA-->                           
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<!-- BOTON VISUALIZAR-->
		<button id="btnGraficar" class="btn btn-success">
			<i class="fas fa-file-excel"></i> VISUALIZAR GRAFICAS
		</button>
	  
		<div id="oli">
			<!-- GRAFICA TEMPERATURA CORPORAL-->
			<hr/>
			<div id="Separa_Grafica">
				<div id="Grafica_Izqui"><!-- Grafica-->
					<canvas id="GraTemperatura" width="1000" height="400"></canvas>
				</div>
				<div id="Posicion_Botton">
					<div id="btnAnimacion" class="wrap1"><!-- Boton Descargar-->
						<button id="DescTemp" class="btn btn-success">
							<i class="fas fa-file-excel"></i> DESCARGAR
						</button>
					</div>
				</div>
			</div><hr/>
			
			<!-- GRAFICA PESO CORPORAL-->
			<div id="Separa_Grafica">
				<div id="Grafica_Izqui"><!-- Grafica-->
					<canvas id="GraPeso" width="1000" height="400"></canvas>
				</div>
				<div id="Posicion_Botton">
					<div id="btnAnimacion" class="wrap1"><!-- Boton Descargar-->
						<button id="DescPes" class="btn btn-success">
							<i class="fas fa-file-excel"></i> DESCARGAR
						</button>				
					</div>
				</div>
			</div><hr/>
			
			<!-- GRAFICA ESTATURA CORPORAL-->
			<div id="Separa_Grafica">
				<div id="Grafica_Izqui"><!-- Grafica-->
					<canvas id="GraEstatura" width="1000" height="400"></canvas>
				</div>
				<div id="Posicion_Botton">
					<div id="btnAnimacion" class="wrap1"><!-- Boton Descargar-->
						<button id="DescEst" class="btn btn-success">
							<i class="fas fa-file-excel"></i> DESCARGAR
						</button>
					</div>
				</div>
			</div><hr/>
			
			<!-- GRAFICA IMC CORPORAL-->
			<div id="Separa_Grafica">
				<div id="Grafica_Izqui"><!-- Grafica-->
					<canvas id="GraImc" width="1000" height="400"></canvas>
				</div>
				<div id="Posicion_Botton">
					<div id="btnAnimacion" class="wrap1"><!-- Boton Descargar-->
						<button id="DescImc" class="btn btn-success">
							<i class="fas fa-file-excel"></i> DESCARGAR
						</button>
					</div>
				</div>
			</div><hr/>	
			
			<!-- GRAFICA O2SAT CORPORAL-->
			<div id="Separa_Grafica">
				<div id="Grafica_Izqui"><!-- Grafica-->
					<canvas id="GraO2Sat" width="1000" height="400"></canvas>
				</div>
				<div id="Posicion_Botton">
					<div id="btnAnimacion" class="wrap1"><!-- Boton Descargar-->
						<button id="DescO2Sa" class="btn btn-success">
							<i class="fas fa-file-excel"></i> DESCARGAR
						</button>
					</div>
				</div>
			</div><hr/>	
			
			<!-- BOTON EXPORAR PDF-->
			<div id="centrar2"><!-- Grafica-->
				<button type="button" class="button2" id="DescPDF"onclick="DescPDF">Descargar Historial en PDF</button>
			</div><hr/>	
		</div>
	</body>
	
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.3/jspdf.debug.js'></script>
			
	<!-- SCRIPT -------------------------------------------------------------------------- -->		
	<!-- SCRIPT PARA EXPORTAR -->
	<script>
		const $btnExportar = document.querySelector("#btnExportar"),
			$tabla = document.querySelector("#tabla");
		$btnExportar.addEventListener("click", function() {
			let tableExport = new TableExport($tabla, {
				exportButtons: false, // No queremos botones
				filename: "Reporte IoMT", //Nombre del archivo de Excel
				sheetname: "IoMT", //Título de la hoja
			});
			let datos = tableExport.getExportData();
			let preferenciasDocumento = datos.tabla.xlsx;
			tableExport.export2file(preferenciasDocumento.data, preferenciasDocumento.mimeType, preferenciasDocumento.filename, preferenciasDocumento.fileExtension, preferenciasDocumento.merges, preferenciasDocumento.RTL, preferenciasDocumento.sheetname);
		});
	</script>		
			


	<!-- GRAFICA TEMPERATURA -->
	<!-- --------------------------------------------------------- -->
	<script>
		var Temp = "";       var Fec = "";
		var Temperatura =[]; var Fecha =[];
	    $("#btnGraficar").click(function() {
			console.log("DESCARGANDOooo")
		$(".GF").parent("tr").find(".GF").each(function() {
		 Fec +=$(this).html()+",";
		});
		$(".GT").parent("tr").find(".GT").each(function() {
		 Temp +=$(this).html()+",";
		});
		
		Temp=Temp.split(',')
		TempLen = Temp.length-1;
		Fec=Fec.split(',')
		for ( var i = 0; i < TempLen; i++ ) {
			Temperatura[i]=Temp[i];
			Fecha[i]=Fec[i];
			}
		var ctx= document.getElementById("GraTemperatura").getContext("2d");
		let gradient=ctx.createLinearGradient(0,0,0,400);
		gradient.addColorStop(0,"rgba(144,0,0,0.7)");
		gradient.addColorStop(1,"rgba(200,0,0,0.3)");
		var myChart= new Chart(ctx,{
			type:"line", //<!--TIPO DE GRAFICA -->
			data:{
				labels:Fecha, //<!--DATO FECHA -->		
				datasets:[{
						label:'TEMPERATURA CORPORAL',
						data:Temperatura, //<!--DATO TEMPERATURA -->
						backgroundColor: gradient,
						borderColor: "#000000",
						borderWidth:4,
							}]},
			options:{
				responsive: false,
				title: {
				 display: true,
				 text: 'HISTORIAL DE LA TEMPERATURA CORPORAL'
				  },
				
				scales:{
					yAxes:[{
						scaleLabel: {
							display: true,
							labelString: "TEMPERATURA [°C]",},
						ticks:{
							beginAtZero:true							
							}}],				
					xAxes:[{
						scaleLabel: {
							display: true,
							labelString: "FECHA [dd/mm/aa]",
						}}]												
			}}});	
		$("#DescTemp").click(function() {
		   myChart.options.title.text = 'Temperatura Corporal - Historial';
		   myChart.update({
			  duration: 0
		   });
		   var link = document.createElement('a');
		   link.href = myChart.toBase64Image();
		   link.download = 'Temperatura Corporal.png';
		   link.click();
		   myChart.options.title.text = 'HISTORIAL: TEMPERATURA CORPORAL';
		   myChart.update({
			  duration: 0
		   });
		});		
	</script>
	
	
	
</body>
</html>
            